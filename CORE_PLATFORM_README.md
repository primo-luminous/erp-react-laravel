# üè¢ Core Platform - Enterprise Authentication & Management System

## üìã Overview

Core Platform ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå ‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÉ‡∏ô‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏° Enterprise ‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î

## üéØ Key Features

### üîê Centralized Authentication
- **Single Sign-On (SSO)** - ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏ó‡∏∏‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
- **JWT/Sanctum Token** - ‡∏£‡∏∞‡∏ö‡∏ö Token ‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢
- **Session Management** - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Session ‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á
- **Device Tracking** - ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö

### üë• User Management
- **Multi-Company Support** - ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏•‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó
- **Department Hierarchy** - ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡πÅ‡∏ö‡∏ö‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô
- **Employee Management** - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
- **Profile Management** - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ

### üõ°Ô∏è Role-Based Access Control (RBAC)
- **Namespace Permissions** - ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÅ‡∏ö‡∏ö namespace (‡πÄ‡∏ä‡πà‡∏ô `erp.users.view`)
- **Module-Based Roles** - ‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° Module
- **Hierarchical Permissions** - ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÅ‡∏ö‡∏ö‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô
- **Dynamic Permission Checking** - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÅ‡∏ö‡∏ö Real-time

### üìä System Registry
- **System Registration** - ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà
- **Dynamic Navigation** - ‡πÄ‡∏°‡∏ô‡∏π‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡πÅ‡∏ö‡∏ö Dynamic
- **Permission Mapping** - ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö
- **Configuration Management** - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö

### üìù Audit & Logging
- **Comprehensive Logging** - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô
- **Cross-System Tracking** - ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≤‡∏°‡∏£‡∏∞‡∏ö‡∏ö
- **User Activity Monitoring** - ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
- **Security Audit Trail** - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

## üèóÔ∏è Architecture

### üìÅ Backend Structure
```
apps/api/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ Models/Core/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ User.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Role.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Permission.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Company.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Department.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SystemRegistry.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AuditLog.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UserSession.php
‚îÇ   ‚îî‚îÄ‚îÄ Http/Controllers/Api/Core/
‚îÇ       ‚îú‚îÄ‚îÄ AuthController.php
‚îÇ       ‚îú‚îÄ‚îÄ UserController.php
‚îÇ       ‚îî‚îÄ‚îÄ SystemRegistryController.php
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ 2024_01_01_000001_create_core_platform_tables.php
‚îÇ   ‚îî‚îÄ‚îÄ seeders/
‚îÇ       ‚îî‚îÄ‚îÄ CorePlatformSeeder.php
‚îî‚îÄ‚îÄ routes/
    ‚îî‚îÄ‚îÄ api/
        ‚îî‚îÄ‚îÄ core.php
```

### üìÅ Frontend Structure
```
apps/web/src/
‚îú‚îÄ‚îÄ services/core/
‚îÇ   ‚îú‚îÄ‚îÄ AuthService.ts
‚îÇ   ‚îî‚îÄ‚îÄ SystemRegistryService.ts
‚îú‚îÄ‚îÄ context/
‚îÇ   ‚îî‚îÄ‚îÄ CoreAuthContext.tsx
‚îú‚îÄ‚îÄ components/core/
‚îÇ   ‚îú‚îÄ‚îÄ SystemNavigator.tsx
‚îÇ   ‚îú‚îÄ‚îÄ ProtectedRoute.tsx
‚îÇ   ‚îî‚îÄ‚îÄ PermissionGate.tsx
‚îî‚îÄ‚îÄ pages/core/
    ‚îú‚îÄ‚îÄ LoginPage.tsx
    ‚îî‚îÄ‚îÄ DashboardPage.tsx
```

## üöÄ Quick Start

### 1. Database Setup
```bash
cd apps/api
php artisan migrate
php artisan db:seed --class=CorePlatformSeeder
```

### 2. Start Development Servers
```bash
# Backend
cd apps/api
php artisan serve

# Frontend
cd apps/web
npm run dev
```

### 3. Access the System
- **URL**: http://localhost:3000/login
- **Demo Credentials**:
  - Super Admin: `admin@enterprise-platform.com` / `admin1234`
  - ERP Admin: `erp.admin@enterprise-platform.com` / `admin1234`
  - Car Rental Manager: `rental.manager@enterprise-platform.com` / `admin1234`
  - Classroom Manager: `classroom.manager@enterprise-platform.com` / `admin1234`

## üìö API Documentation

### Authentication Endpoints
```http
POST /api/core/auth/login
POST /api/core/auth/logout
POST /api/core/auth/refresh
GET  /api/core/auth/me
GET  /api/core/auth/sessions
GET  /api/core/auth/check-system/{systemKey}
```

### User Management Endpoints
```http
GET    /api/core/users
POST   /api/core/users
GET    /api/core/users/{id}
PUT    /api/core/users/{id}
DELETE /api/core/users/{id}
POST   /api/core/users/{id}/roles
GET    /api/core/users/{id}/permissions
```

### System Registry Endpoints
```http
GET  /api/core/systems
POST /api/core/systems
GET  /api/core/systems/{systemKey}
PUT  /api/core/systems/{systemKey}
DELETE /api/core/systems/{systemKey}
GET  /api/core/systems/navigation
```

## üîß Configuration

### System Registration Example
```php
SystemRegistry::create([
    'system_key' => 'new_system',
    'name' => 'New System',
    'display_name' => 'New System',
    'description' => 'Description of new system',
    'version' => '1.0.0',
    'icon' => 'NewIcon',
    'color' => '#FF6B6B',
    'url_prefix' => '/new-system',
    'api_base_url' => '/api/new-system',
    'config' => [
        'features' => ['feature1', 'feature2'],
    ],
    'permissions' => [
        'new_system.users.view',
        'new_system.users.create',
    ],
    'is_enabled' => true,
    'requires_auth' => true,
    'sort_order' => 4,
]);
```

### Permission Structure
```
{module}.{resource}.{action}

Examples:
- core.users.view
- erp.employees.create
- carrental.bookings.edit
- smartclassroom.equipment.control
```

## üîí Security Features

### Authentication Security
- **Password Hashing** - ‡πÉ‡∏ä‡πâ bcrypt ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
- **Token Expiration** - Token ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- **Session Management** - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Session ‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á
- **Device Tracking** - ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö

### Authorization Security
- **Permission Validation** - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏∏‡∏Å API call
- **Role-Based Access** - ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏ï‡∏≤‡∏°‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó
- **Module Isolation** - ‡πÅ‡∏¢‡∏Å‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ï‡∏≤‡∏° Module
- **Audit Logging** - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

### Data Security
- **Input Validation** - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Input
- **SQL Injection Protection** - ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô SQL Injection
- **XSS Protection** - ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Cross-Site Scripting
- **CSRF Protection** - ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Cross-Site Request Forgery

## üìä Database Schema

### Core Tables
- **companies** - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó
- **departments** - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ú‡∏ô‡∏Å
- **users** - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
- **roles** - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó
- **permissions** - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå
- **role_permissions** - ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó-‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå
- **user_roles** - ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ-‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó
- **system_registry** - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö
- **audit_logs** - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
- **user_sessions** - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Session
- **system_settings** - ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö

## üîÑ Integration Guide

### Adding New System

1. **Register System**
```php
SystemRegistry::create([...]);
```

2. **Create Permissions**
```php
Permission::createPermission('newsystem', 'users', 'view', 'View Users');
Permission::createPermission('newsystem', 'users', 'create', 'Create Users');
```

3. **Create Roles**
```php
Role::create([
    'name' => 'newsystem_admin',
    'display_name' => 'New System Administrator',
    'module' => 'newsystem',
    'company_id' => $companyId,
]);
```

4. **Assign Permissions to Role**
```php
$role->syncPermissions(['newsystem.users.view', 'newsystem.users.create']);
```

5. **Frontend Integration**
```tsx
// Add to SystemNavigator
<Link to="/new-system">New System</Link>

// Use PermissionGate
<PermissionGate permissions={['newsystem.users.view']}>
  <NewSystemComponent />
</PermissionGate>
```

## üß™ Testing

### Backend Tests
```bash
cd apps/api
php artisan test --filter=Core
```

### Frontend Tests
```bash
cd apps/web
npm test
```

## üìà Performance Optimization

### Database Optimization
- **Indexing Strategy** - ‡∏™‡∏£‡πâ‡∏≤‡∏á Index ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°
- **Query Optimization** - ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á Query ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô
- **Connection Pooling** - ‡πÉ‡∏ä‡πâ Connection Pool
- **Caching** - ‡πÉ‡∏ä‡πâ Redis Cache

### Frontend Optimization
- **Code Splitting** - ‡πÅ‡∏ö‡πà‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏ï‡∏≤‡∏° Module
- **Lazy Loading** - ‡πÇ‡∏´‡∏•‡∏î Component ‡πÅ‡∏ö‡∏ö Lazy
- **State Management** - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ State ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û
- **Bundle Optimization** - ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á Bundle Size

## üîß Troubleshooting

### Common Issues

1. **Token Expired**
   - Solution: Implement automatic token refresh

2. **Permission Denied**
   - Solution: Check user roles and permissions

3. **System Not Found**
   - Solution: Verify system registration in SystemRegistry

4. **Session Invalid**
   - Solution: Clear localStorage and re-login

### Debug Mode
```bash
# Enable debug mode
APP_DEBUG=true
LOG_LEVEL=debug
```

## üìû Support

‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:
- **Documentation**: [Core Platform Docs](./docs/)
- **Issues**: [GitHub Issues](https://github.com/your-repo/issues)
- **Email**: support@enterprise-platform.com

---

*Core Platform - The foundation of your enterprise ecosystem*
